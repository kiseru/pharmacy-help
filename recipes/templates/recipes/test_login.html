<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
</head>
<body>
<p>
  <label for="email">e-mail: </label>
  <input type="email" id="email">
</p>
<p>
  <label for="password">password: </label>
  <input type="password" id="password">
</p>
<button id="submit">Log in</button>
<script type="application/javascript">
$('#submit').click(function () {
      post = {
        email: $('#email').val(),
        password: $('#password').val()
      };
      console.log(post);

      $.ajax({
        url:'/api/login',
        type:"POST",
        data: JSON.stringify(post),
        success: success,
        error: function (request, textStatus, errorThrown) {
          alert(textStatus);
        }
      });



    });
    function success(data) {
      alert('Success!');
    }

    $.ajaxSetup({
       beforeSend: function(xhr, settings) {
           function getCookie(name) {
               var cookieValue = null;
               if (document.cookie && document.cookie != '') {
                   var cookies = document.cookie.split(';');
                   for (var i = 0; i < cookies.length; i++) {
                       var cookie = jQuery.trim(cookies[i]);
                       // Does this cookie string begin with the name we want?
                   if (cookie.substring(0, name.length + 1) == (name + '=')) {
                       cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                       break;
                   }
               }
           }
           return cookieValue;
           }
           if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
               // Only send the token to relative URLs i.e. locally.
               xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
           }
       }
});
</script>
</body>
</html>
